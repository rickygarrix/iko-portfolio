(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7769],{55:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(5155),a=t(2115),n=t(5695),d=t(3168);function i(){let[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)(!0),c=(0,n.useRouter)();(0,a.useEffect)(()=>{(async()=>{let{data:{user:e}}=await d.N.auth.getUser();if(!e){alert("ログインが必要です"),c.push("/login");return}if("chloerickyc@gmail.com"!==e.email){alert("アクセス権限がありません"),c.push("/");return}})()},[c]),(0,a.useEffect)(()=>{(async()=>{let{data:e,error:t}=await d.N.from("stores").select("id, name, genre, is_recommended, is_published").eq("is_published",!0);t?console.error("取得エラー:",t):s(e||[]),i(!1)})()},[]);let l=async(t,r)=>{if(r&&e.filter(e=>e.is_recommended).length>=3)return void alert("おすすめにできるのは最大3店舗までです");let{error:a}=await d.N.from("stores").update({is_recommended:r}).eq("id",t);a?alert("おすすめ更新に失敗しました"):s(e=>e.map(e=>e.id===t?{...e,is_recommended:r}:e))},o=async e=>{if(!window.confirm("この店舗を非公開にしますか？"))return;let{error:t}=await d.N.from("stores").update({is_published:!1}).eq("id",e);t?alert("非公開への変更に失敗しました"):(alert("非公開にしました"),s(s=>s.filter(s=>s.id!==e)))};return t?(0,r.jsx)("div",{className:"text-center p-10 text-gray-800",children:"読み込み中..."}):(0,r.jsxs)("div",{className:"min-h-screen bg-[#FEFCF6] pt-24 px-10 pb-10 text-gray-800",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center mb-6",children:"公開済み店舗一覧"}),0===e.length?(0,r.jsx)("p",{className:"text-center text-gray-500",children:"公開中の店舗はありません。"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white rounded shadow",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 text-gray-700",children:[(0,r.jsx)("th",{className:"py-2 px-4 border",children:"店名"}),(0,r.jsx)("th",{className:"py-2 px-4 border",children:"ジャンル"}),(0,r.jsx)("th",{className:"py-2 px-4 border",children:"おすすめ"}),(0,r.jsx)("th",{className:"py-2 px-4 border",children:"操作"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{className:"text-center",children:[(0,r.jsx)("td",{className:"py-2 px-4 border",children:e.name}),(0,r.jsx)("td",{className:"py-2 px-4 border",children:e.genre}),(0,r.jsx)("td",{className:"py-2 px-4 border",children:e.is_recommended?"\uD83C\uDF1Fおすすめ中":"ー"}),(0,r.jsx)("td",{className:"py-2 px-4 border",children:(0,r.jsxs)("div",{className:"flex flex-wrap justify-center gap-2",children:[(0,r.jsx)("button",{className:"bg-blue-500 text-white font-semibold rounded px-4 py-2 hover:bg-blue-600",onClick:()=>c.push("/admin/stores/".concat(e.id)),children:"詳細確認"}),e.is_recommended?(0,r.jsx)("button",{className:"bg-gray-400 text-white font-semibold rounded px-4 py-2 hover:bg-gray-500",onClick:()=>l(e.id,!1),children:"おすすめ解除"}):(0,r.jsx)("button",{className:"bg-green-500 text-white font-semibold rounded px-4 py-2 hover:bg-green-600",onClick:()=>l(e.id,!0),children:"おすすめにする"}),(0,r.jsx)("button",{className:"bg-red-500 text-white font-semibold rounded px-4 py-2 hover:bg-red-600",onClick:()=>o(e.id),children:"非公開にする"})]})})]},e.id))})]})}),(0,r.jsx)("div",{className:"flex justify-center mt-10",children:(0,r.jsx)("button",{onClick:()=>c.push("/admin"),className:"bg-gray-500 text-white py-2 px-6 rounded hover:bg-gray-600",children:"管理画面トップに戻る"})})]})}},1777:(e,s,t)=>{Promise.resolve().then(t.bind(t,55))},3168:(e,s,t)=>{"use strict";t.d(s,{N:()=>r});let r=(0,t(851).UU)("https://bqexmwjcmtyypzucndrb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxZXhtd2pjbXR5eXB6dWNuZHJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA2MjA5NjQsImV4cCI6MjA1NjE5Njk2NH0.LgmwOIcW4UsTqwigP7BgXBrQmtSah362_dsWqjecTQQ")},5695:(e,s,t)=>{"use strict";var r=t(8999);t.o(r,"notFound")&&t.d(s,{notFound:function(){return r.notFound}}),t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})}},e=>{var s=s=>e(e.s=s);e.O(0,[851,8441,1684,7358],()=>s(1777)),_N_E=e.O()}]);