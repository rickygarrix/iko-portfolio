"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[854],{1473:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var n=o(5155),l=o(2115),r=o(9047),i=o(6855),a=o(2558);let s={width:"100%",height:"80vh"};function p(){let{isLoaded:e}=(0,r.KD)({googleMapsApiKey:"AIzaSyCTM0zn6wKK2F3nG4Qp0xHoQaAMn-dhrac"}),[t,o]=(0,l.useState)([]),[p,d]=(0,l.useState)(null),[g,c]=(0,l.useState)(null),[u,x]=(0,l.useState)(null),[h,f]=(0,l.useState)(!1),[b,m]=(0,l.useState)(!1),C=(0,l.useRef)(null);(0,l.useEffect)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:o}=e.coords,n={lat:t,lng:o};console.log("\uD83D\uDCCD 現在地取得:",n),c(n),x(n),y(t,o)},e=>console.error("\uD83D\uDCCD 現在地取得エラー:",e))},[]);let y=async(e,t)=>{if(!e||!t)return;let{data:n,error:l}=await i.N.from("stores").select("id, latitude, longitude, name, area, genre, opening_hours");if(l){console.error("\uD83D\uDD25 Supabase Error:",l.message);return}if(n){console.log("\uD83D\uDCCD 取得した店舗データ:",n);let l=n.map(e=>({id:e.id,lat:Number(e.latitude),lng:Number(e.longitude),name:e.name,area:e.area,genre:e.genre,isOpen:(0,a.C)(e.opening_hours).isOpen})).filter(o=>Math.sqrt(Math.pow(o.lat-e,2)+Math.pow(o.lng-t,2))<=5e3/111e3);o(b?l.filter(e=>e.isOpen):l)}};return e&&u?(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsxs)(r.u6,{mapContainerStyle:s,center:u,zoom:14,onLoad:e=>{C.current=e},onDragEnd:()=>{if(C.current){let e=C.current.getCenter();e&&(x({lat:e.lat(),lng:e.lng()}),f(!0))}},children:[g&&(0,n.jsx)(r.jl,{center:g,radius:50,options:{strokeColor:"#007bff",strokeOpacity:.8,strokeWeight:2,fillColor:"#007bff",fillOpacity:.35}}),t.map((e,t)=>(0,n.jsx)(r.pH,{position:{lat:e.lat,lng:e.lng},onClick:()=>{console.log("✅ ピンがクリックされた:",e),d(e)},label:{text:e.name,color:"black",fontSize:"12px",fontWeight:"bold"}},t))]}),h&&(0,n.jsxs)("div",{style:{position:"absolute",top:20,left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.95)",padding:"12px",borderRadius:"8px",boxShadow:"0px 4px 10px rgba(0,0,0,0.2)"},children:[(0,n.jsx)("button",{onClick:()=>{u&&(y(u.lat,u.lng),f(!1))},style:{backgroundColor:"#ff5722",color:"white",padding:"10px 20px",borderRadius:"5px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",border:"2px solid #e64a19",marginRight:"12px"},children:"\uD83D\uDD0D このエリアで検索"}),(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",fontSize:"14px",color:"#333",fontWeight:"bold"},children:[(0,n.jsx)("input",{type:"checkbox",checked:b,onChange:()=>m(!b),style:{marginRight:"6px",transform:"scale(1.2)"}}),"営業中のみ表示"]})]}),p&&(0,n.jsxs)("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",backgroundColor:"white",padding:"16px",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",boxShadow:"0px -2px 10px rgba(0, 0, 0, 0.1)",textAlign:"center",color:"black",fontSize:"16px",cursor:"pointer"},children:[(0,n.jsx)("h2",{style:{fontSize:"18px",fontWeight:"bold"},children:p.name}),(0,n.jsxs)("p",{children:["\uD83D\uDCCD ",p.area," / \uD83C\uDFB5 ",p.genre]}),(0,n.jsx)("p",{style:{color:p.isOpen?"green":"red",fontWeight:"bold"},children:p.isOpen?"営業中":"営業時間外"})]})]}):(0,n.jsx)("p",{children:"Loading Google Maps..."})}}}]);